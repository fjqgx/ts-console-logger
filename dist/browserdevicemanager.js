/*! For license information please see browserdevicemanager.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(function(){return(()=>{"use strict";var e={304:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserDeviceManager=void 0;var r=n(101),o=n(853),i=n(62),c=n(913),a=n(331),s=n(1),u=n(935),p=function(){function e(){this.systemUtil=new r.SystemUtil,this.deviceManager=this.createDeviceManager()}return e.prototype.getCameraList=function(){return this.deviceManager.getCameraList()},e.prototype.getMicList=function(){return this.deviceManager.getMicList()},e.prototype.getAudioTrack=function(e){return this.deviceManager.getAudioTrack(e)},e.prototype.getVideoTrack=function(e){return this.deviceManager.getVideoTrack(e)},e.prototype.getScreenTrack=function(e){return this.deviceManager.getScreenTrack(e)},e.prototype.createDeviceManager=function(){return this.systemUtil.isWindows?new u.WindowsDeviceManager:this.systemUtil.isAndroid?new o.AndroidDeviceManager:this.systemUtil.isIos?new c.IosDeviceManager:this.systemUtil.isMacOS?new s.MacDeviceManager:this.systemUtil.isLinux?new a.LinuxDeviceManager:new i.BaseDeviceManager},e}();t.BrowserDeviceManager=p},603:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceError=t.ErrorCode=void 0,(n=t.ErrorCode||(t.ErrorCode={}))[n.ERROR_DEVICE_UNKNOWNERROR=1e4]="ERROR_DEVICE_UNKNOWNERROR",n[n.ERROR_DEVICE_AUDIODEVICE_NOTFOUND=10001]="ERROR_DEVICE_AUDIODEVICE_NOTFOUND",n[n.ERROR_DEVICE_VIDEODEVICE_NOTFOUND=10002]="ERROR_DEVICE_VIDEODEVICE_NOTFOUND",n[n.ERROR_DEVICE_AUDIODEVICE_NOTALLOWED=10003]="ERROR_DEVICE_AUDIODEVICE_NOTALLOWED",n[n.ERROR_DEVICE_VIDEODEVICE_NOTALLOWED=10004]="ERROR_DEVICE_VIDEODEVICE_NOTALLOWED",n[n.ERROR_DEVICE_AUDIODEVICE_NOTREADABLE=10005]="ERROR_DEVICE_AUDIODEVICE_NOTREADABLE",n[n.ERROR_DEVICE_VIDEODEVICE_NOTREADABLE=10006]="ERROR_DEVICE_VIDEODEVICE_NOTREADABLE",n[n.ERROR_DEVICE_NOTSUPPORT=2e4]="ERROR_DEVICE_NOTSUPPORT";t.DeviceError=function(e,t){this.code=e,this.reason=t}},853:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AndroidDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(n(583).MobileDeviceManager);t.AndroidDeviceManager=i},62:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDeviceManager=void 0;var r,o=n(603);!function(e){e.Camera="videoinput",e.Mic="audioinput"}(r||(r={}));var i=function(){function e(){this.mediaStream=new MediaStream}return e.prototype.getCameraList=function(){var e=this;return new Promise((function(t,n){e.checkSupport()?e.getDeviceRight(r.Camera).then((function(){e.getDeviceList(r.Camera).then((function(e){t(e)})).catch((function(e){n(e)}))})).catch((function(e){n(e)})):n(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getMicList=function(){var e=this;return new Promise((function(t,n){e.checkSupport()?e.getDeviceRight(r.Mic).then((function(){e.getDeviceList(r.Mic).then((function(e){t(e)})).catch((function(e){n(e)}))})).catch((function(e){n(e)})):n(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getAudioTrack=function(e){var t=this;return new Promise((function(n,i){if(t.checkSupport()){var c;c=e&&e.deviceId?{deviceId:e.deviceId}:{audio:!0},navigator.mediaDevices.getUserMedia(c).then((function(e){n(e.getAudioTracks()[0])})).catch((function(e){i(t.parseError(r.Mic,e))}))}else i(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getVideoTrack=function(e){var t=this;return new Promise((function(n,i){if(t.checkSupport()){var c=t.createVideoConstraints(e);navigator.mediaDevices.getUserMedia(c).then((function(e){n(e.getVideoTracks()[0])})).catch((function(e){i(t.parseError(r.Camera,e))}))}else i(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getScreenTrack=function(e){return new Promise((function(e,t){}))},e.prototype.checkSupport=function(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia)},e.prototype.getDeviceList=function(e){return new Promise((function(t,n){navigator.mediaDevices.enumerateDevices().then((function(n){var r=[];n.forEach((function(t){t.kind===e&&r.push(t)})),t(r)})).catch((function(e){n(e)}))}))},e.prototype.getDeviceRight=function(e){return new Promise((function(t,n){var o;r.Camera===e?o={video:!0}:r.Mic===e&&(o={audio:!0}),navigator.mediaDevices.getUserMedia(o).then((function(e){e.getVideoTracks().forEach((function(e){e.stop()})),t(void 0)})).catch((function(e){n(e)}))}))},e.prototype.parseError=function(e,t){return new o.DeviceError(o.ErrorCode.ERROR_DEVICE_UNKNOWNERROR,"")},e.prototype.createVideoConstraints=function(e){return e.deviceId||e.width||e.height?{video:{deviceId:e.deviceId,width:e.width,height:e.height}}:{video:!0}},e}();t.BaseDeviceManager=i},913:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.IosDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(n(583).MobileDeviceManager);t.IosDeviceManager=i},331:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinuxDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(n(62).BaseDeviceManager);t.LinuxDeviceManager=i},1:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.MacDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(n(62).BaseDeviceManager);t.MacDeviceManager=i},583:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.MobileDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.createVideoConstraints=function(e){return e.deviceId||e.facingMode||e.width||e.height?{video:{deviceId:e.facingMode?e.facingMode:e.deviceId,width:e.width,height:e.height}}:{video:!0}},t}(n(62).BaseDeviceManager);t.MobileDeviceManager=i},935:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WindowsDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(n(62).BaseDeviceManager);t.WindowsDeviceManager=i},607:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserDeviceManager=void 0;var r=n(304);Object.defineProperty(t,"BrowserDeviceManager",{enumerable:!0,get:function(){return r.BrowserDeviceManager}}),window&&(window.BrowserDeviceManager=r.BrowserDeviceManager)},101:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SystemUtil=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.MacOS=1]="MacOS",e[e.Windows=2]="Windows",e[e.Android=3]="Android",e[e.Iphone=4]="Iphone",e[e.Ipad=5]="Ipad",e[e.Linux=6]="Linux"}(n||(n={}));var r=function(){function e(){this.systemType=n.Unknown,this.getSystemInfo()}return Object.defineProperty(e.prototype,"isIos",{get:function(){return this.systemType===n.Ipad||this.systemType===n.Iphone},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAndroid",{get:function(){return this.systemType===n.Android},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMacOS",{get:function(){return this.systemType===n.MacOS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWindows",{get:function(){return this.systemType===n.Windows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLinux",{get:function(){return this.systemType===n.Linux},enumerable:!1,configurable:!0}),e.prototype.getSystemInfo=function(){if(navigator&&navigator.userAgent){var e=navigator.userAgent.toLocaleLowerCase();e.indexOf("ipad")>-1?this.systemType=n.Ipad:e.indexOf("iphone")>-1?this.systemType=n.Iphone:e.indexOf("android")>-1?this.systemType=n.Android:e.indexOf("win")>-1?this.systemType=n.Windows:e.indexOf("mac")>-1?this.systemType=n.MacOS:e.indexOf("linux")>-1?this.systemType=n.Linux:e.indexOf("")>-1&&(this.systemType=n.Unknown)}},e}();t.SystemUtil=r}},t={};return function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(607)})()}));