/*! For license information please see browserdevicemanager.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BrowserDeviceManager=t():e.BrowserDeviceManager=t()}(self,(function(){return(()=>{"use strict";var e={304:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserDeviceManager=void 0;var n=r(101),o=r(853),i=r(62),a=r(913),c=r(331),s=r(1),u=r(935),p=function(){function e(){this.systemUtil=new n.SystemUtil,this.deviceManager=this.createDeviceManager()}return e.prototype.getCameraList=function(){return this.deviceManager.getCameraList()},e.prototype.getMicList=function(){return this.deviceManager.getMicList()},e.prototype.getAudioTrack=function(e){return this.deviceManager.getAudioTrack(e)},e.prototype.getMediaStream=function(){return this.deviceManager.getMediaStream()},e.prototype.getVideoTrack=function(e){return this.deviceManager.getVideoTrack(e)},e.prototype.getScreenTrack=function(e){return this.deviceManager.getScreenTrack(e)},e.prototype.releaseAllStream=function(){return this.deviceManager.releaseAllStream()},e.prototype.createDeviceManager=function(){return this.systemUtil.isWindows?new u.WindowsDeviceManager:this.systemUtil.isAndroid?new o.AndroidDeviceManager:this.systemUtil.isIos?new a.IosDeviceManager:this.systemUtil.isMacOS?new s.MacDeviceManager:this.systemUtil.isLinux?new c.LinuxDeviceManager:new i.BaseDeviceManager},e}();t.BrowserDeviceManager=p},603:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceError=t.ErrorCode=void 0,(r=t.ErrorCode||(t.ErrorCode={}))[r.ERROR_DEVICE_UNKNOWNERROR=1e4]="ERROR_DEVICE_UNKNOWNERROR",r[r.ERROR_DEVICE_AUDIODEVICE_NOTFOUND=10001]="ERROR_DEVICE_AUDIODEVICE_NOTFOUND",r[r.ERROR_DEVICE_VIDEODEVICE_NOTFOUND=10002]="ERROR_DEVICE_VIDEODEVICE_NOTFOUND",r[r.ERROR_DEVICE_AUDIODEVICE_NOTALLOWED=10003]="ERROR_DEVICE_AUDIODEVICE_NOTALLOWED",r[r.ERROR_DEVICE_VIDEODEVICE_NOTALLOWED=10004]="ERROR_DEVICE_VIDEODEVICE_NOTALLOWED",r[r.ERROR_DEVICE_AUDIODEVICE_NOTREADABLE=10005]="ERROR_DEVICE_AUDIODEVICE_NOTREADABLE",r[r.ERROR_DEVICE_VIDEODEVICE_NOTREADABLE=10006]="ERROR_DEVICE_VIDEODEVICE_NOTREADABLE",r[r.ERROR_DEVICE_NOTSUPPORT=2e4]="ERROR_DEVICE_NOTSUPPORT";t.DeviceError=function(e,t){this.code=e,this.reason=t}},853:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.AndroidDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(583).MobileDeviceManager);t.AndroidDeviceManager=i},62:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDeviceManager=void 0;var n,o=r(603);!function(e){e.Camera="videoinput",e.Mic="audioinput"}(n||(n={}));var i=function(){function e(){this.mediaStream=new MediaStream}return e.prototype.getCameraList=function(){var e=this;return new Promise((function(t,r){e.checkSupport()?e.getDeviceRight(n.Camera).then((function(){e.getDeviceList(n.Camera).then((function(e){t(e)})).catch((function(e){r(e)}))})).catch((function(e){r(e)})):r(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getMicList=function(){var e=this;return new Promise((function(t,r){e.checkSupport()?e.getDeviceRight(n.Mic).then((function(){e.getDeviceList(n.Mic).then((function(e){t(e)})).catch((function(e){r(e)}))})).catch((function(e){r(e)})):r(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getMediaStream=function(){var e=this;return new Promise((function(t,r){e.checkSupport()?navigator.mediaDevices.getUserMedia({video:!0}).then((function(r){e.mediaStream=r,t(r)})).catch((function(t){r(e.parseError(n.Camera,t))})):r(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getAudioTrack=function(e){var t=this;return new Promise((function(e,r){t.checkSupport()?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e(t.getAudioTracks()[0])})).catch((function(e){r(t.parseError(n.Mic,e))})):r(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getVideoTrack=function(e){var t=this;return new Promise((function(e,r){t.checkSupport()?navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){e(t.getVideoTracks()[0])})).catch((function(e){r(t.parseError(n.Camera,e))})):r(new o.DeviceError(o.ErrorCode.ERROR_DEVICE_NOTSUPPORT,"not support navigator.mediaDevices"))}))},e.prototype.getScreenTrack=function(e){return new Promise((function(e,t){}))},e.prototype.releaseAllStream=function(){var e=this;this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){e.mediaStream.removeTrack(t),t.stop()}))},e.prototype.checkSupport=function(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia)},e.prototype.getDeviceList=function(e){return new Promise((function(t,r){navigator.mediaDevices.enumerateDevices().then((function(r){var n=[];r.forEach((function(t){t.kind===e&&n.push(t)})),t(n)})).catch((function(e){r(e)}))}))},e.prototype.getDeviceRight=function(e){return new Promise((function(t,r){var o;n.Camera===e?o={video:!0}:n.Mic===e&&(o={audio:!0}),navigator.mediaDevices.getUserMedia(o).then((function(e){e.getVideoTracks().forEach((function(e){e.stop()})),t(void 0)})).catch((function(e){r(e)}))}))},e.prototype.parseError=function(e,t){return new o.DeviceError(o.ErrorCode.ERROR_DEVICE_UNKNOWNERROR,"")},e}();t.BaseDeviceManager=i},913:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.IosDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(583).MobileDeviceManager);t.IosDeviceManager=i},331:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinuxDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(62).BaseDeviceManager);t.LinuxDeviceManager=i},1:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.MacDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(62).BaseDeviceManager);t.MacDeviceManager=i},583:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.MobileDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(62).BaseDeviceManager);t.MobileDeviceManager=i},935:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.WindowsDeviceManager=void 0;var i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(62).BaseDeviceManager);t.WindowsDeviceManager=i},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserDeviceManager=void 0;var n=r(304);Object.defineProperty(t,"BrowserDeviceManager",{enumerable:!0,get:function(){return n.BrowserDeviceManager}}),window&&(window.BrowserDeviceManager=n.BrowserDeviceManager)},101:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SystemUtil=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.MacOS=1]="MacOS",e[e.Windows=2]="Windows",e[e.Android=3]="Android",e[e.Iphone=4]="Iphone",e[e.Ipad=5]="Ipad",e[e.Linux=6]="Linux"}(r||(r={}));var n=function(){function e(){this.systemType=r.Unknown,this.getSystemInfo()}return Object.defineProperty(e.prototype,"isIos",{get:function(){return this.systemType===r.Ipad||this.systemType===r.Iphone},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAndroid",{get:function(){return this.systemType===r.Android},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMacOS",{get:function(){return this.systemType===r.MacOS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWindows",{get:function(){return this.systemType===r.Windows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLinux",{get:function(){return this.systemType===r.Linux},enumerable:!1,configurable:!0}),e.prototype.getSystemInfo=function(){if(navigator&&navigator.userAgent){var e=navigator.userAgent.toLocaleLowerCase();e.indexOf("ipad")>-1?this.systemType=r.Ipad:e.indexOf("iphone")>-1?this.systemType=r.Iphone:e.indexOf("android")>-1?this.systemType=r.Android:e.indexOf("win")>-1?this.systemType=r.Windows:e.indexOf("mac")>-1?this.systemType=r.MacOS:e.indexOf("linux")>-1?this.systemType=r.Linux:e.indexOf("")>-1&&(this.systemType=r.Unknown)}},e}();t.SystemUtil=n}},t={};return function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(607)})()}));